<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>مسح رمز الحضور</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Cairo', sans-serif;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
        }

        h2 {
            margin-bottom: 20px;
            color: #0077b6;
        }

        #reader {
            width: 300px;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
            border-radius: 10px;
            background-color: #fff;
            padding: 10px;
        }
    </style>
</head>
<body>
    <h2>📷 امسح رمز QR لتسجيل حضورك</h2>
    <div id="reader"></div>

    <script>
      const html5QrCode = new Html5Qrcode("reader");
  
      const config = {
          fps: 10,
          qrbox: 250
      };
  
      Html5Qrcode.getCameras().then(devices => {
          if (devices && devices.length) {
              // ابحث عن كاميرا خلفية
              const backCamera = devices.find(device => device.label.toLowerCase().includes("back"));
              const cameraId = backCamera ? backCamera.id : devices[0].id;
  
              html5QrCode.start(
                  cameraId,
                  config,
                  decodedText => {
                      console.log(`✅ رمز تم مسحه: ${decodedText}`);
                      window.location.href = decodedText;
                  },
                  errorMessage => {
                      console.warn(`❌ فشل المسح: ${errorMessage}`);
                  }
              );
          }
      }).catch(err => {
          console.error("خطأ في الحصول على الكاميرات:", err);
      });
  </script>
  
</body>
</html>
