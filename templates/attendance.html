<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>جدول الحضور</title>
  <link rel="stylesheet" href="/static/style.css">
  <style>
    body {
      font-family: Tahoma, sans-serif;
      background-color: #f0f2f5;
      padding: 30px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #fff;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 12px;
      text-align: center;
    }
    th {
      background-color: #6c757d;
      color: #fff;
    }
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 30px;
    }
    .export-btn {
      display: block;
      margin: 10px auto;
      text-align: center;
      font-size: 20px;
    }
  </style>
</head>

<body>
  <h1>جدول الحضور</h1>
  <a href="/export_courses" class="export-btn" title="تصدير إلى Excel" style="padding: 8px 16px; background-color: #6c757d; color: white; text-decoration: none; border-radius: 5px;">📤</a>
   <form action="/attendance" method="get" style="text-align:center; margin-bottom: 20px;">
  <input type="text" name="student_id" placeholder="🔍 الرقم الجامعي" required>
  <button type="submit">بحث</button>
 </form>

  <table>
    <tr>
      <th>الطالب</th>
      <th>المادة</th>
      <th>القسم</th>
      <th>السنة</th>
      <th>الفصل</th>
      <th>التاريخ</th>
      <th>الوقت</th>
      <th>الحالة</th>
      <th>إجراءات</th>
    </tr>
    {% for entry in attendance %}
    <tr>
      <td>{{ entry.student_name }}</td>
      <td>{{ entry.course_name }}</td>
      <td>{{ entry.department_name }}</td>
      <td>{{ entry.year_name }}</td>
      <td>{{ entry.semester_name }}</td>
      <td>{{ entry.date }}</td>
      <td>{{ entry.time }}</td>
      <td>{{ entry.status }}</td>
      <td>
        <form action="/delete_attendance/{{ entry.id }}" method="get" style="display:inline;">
          <button type="submit">🗑 حذف</button>
        </form>
        <form action="/edit_attendance/{{ entry.id }}" method="post" style="display:inline;">
          <input type="date" name="attendance_date" value="{{ entry.date }}" required>
          <select name="status" required>
            <option value="حاضر" {% if entry.status == "حاضر" %}selected{% endif %}>حاضر</option>
            <option value="غائب" {% if entry.status == "غائب" %}selected{% endif %}>غائب</option>
          </select>
          <button type="submit">✏ تعديل</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </table>

  <h2>تسجيل حضور جديد</h2>
  <form action="/add_attendance" method="post">
    <input type="text" name="student_name" placeholder="اسم الطالب" required>
    <input type="text" name="course_name" placeholder="اسم المادة" required>
    <input type="text" name="department_name" placeholder="اسم القسم" required>
    <input type="text" name="year_name" placeholder="السنة الدراسية" required>
    <input type="text" name="semester_name" placeholder="الفصل الدراسي" required>
    <input type="date" name="attendance_date" required>
    <input type="time" name="attendance_time" required>
    <select name="status" required>
      <option value="حاضر">حاضر</option>
      <option value="غائب">غائب</option>
    </select>
    <button type="submit">➕ تسجيل حضور</button>
  </form>
</body>
</html>
